<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Hour Logger</title>

  <!-- PWA essentials -->
  <link rel="manifest" href="manifest.webmanifest">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
  <link rel="apple-touch-icon" href="icon-192.png">

  <style>
    :root { --pad: 16px; --radius: 16px; --bg: #fafafa; --card: #ffffff; --muted: #6b7280; --text: #111827; }
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body { margin: 0; font-family: -apple-system, system-ui, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background: var(--bg); color: var(--text); }

    /* Top bar */
    .topbar { position: sticky; top: 0; display: flex; align-items: center; gap: 8px; padding: 12px var(--pad); background: #fff; border-bottom: 1px solid #eee; z-index: 10; }
    .back { border: 1px solid #e5e7eb; background: #fff; border-radius: 12px; padding: 8px 12px; font-size: 14px; }
    .title { font-weight: 700; font-size: 18px; margin-left: 4px; }
    .spacer { flex: 1; }
    .pill { display: inline-block; padding: 4px 10px; border: 1px solid #e5e7eb; border-radius: 999px; font-size: 12px; color: #374151; background: #fff; }

    /* Views */
    .view { display: none; padding: var(--pad); }
    .view.active { display: block; }

    /* Hero */
    .hero { position: relative; min-height: 140px; border-radius: 24px; overflow: hidden; background: radial-gradient(80% 80% at 50% 30%, #eef6ff, #fff); border: 1px solid #eef2f7; box-shadow: 0 1px 4px rgba(0,0,0,.06); display: flex; align-items: center; justify-content: center; }
    .hero::after { content: ""; position: absolute; inset: 0; background-image: url('icon-512.png'); background-size: 50%; background-position: center; background-repeat: no-repeat; opacity: .06; }
    .hero h1 { position: relative; z-index: 1; font-size: 24px; margin: 0; }

    .cards { display: grid; grid-template-columns: 1fr; gap: 12px; margin-top: 14px; }
    .card { background: var(--card); border: 1px solid #eee; border-radius: 18px; padding: 16px; display: flex; align-items: center; gap: 12px; box-shadow: 0 1px 3px rgba(0,0,0,.05); }
    .card h3 { margin: 0; font-size: 18px; }
    .card p { margin: 4px 0 0; color: var(--muted); font-size: 14px; }
    .card button { margin-left: auto; border: 1px solid #111; background: #111; color: #fff; border-radius: 12px; padding: 10px 14px; }

    /* Groups, inputs, buttons */
    .group { background: var(--card); border: 1px solid #eee; border-radius: 16px; padding: 14px; margin-bottom: 12px; }
    label { display: block; font-size: 13px; color: var(--muted); margin-bottom: 6px; }
    input[type="time"], input[type="date"], input[type="text"], input[type="number"] { width: 100%; border: 1px solid #e5e7eb; border-radius: 12px; padding: 10px; font-size: 16px; }
    .btn { border: 1px solid #e5e7eb; background: #fff; border-radius: 12px; padding: 10px 14px; font-size: 15px; }
    .btn.primary { background: #111; border-color: #111; color: #fff; }
    .btn.danger { border-color: #ef4444; color: #ef4444; }

    /* Logger responsive layout */
    .logger-grid { display: grid; grid-template-columns: 1fr; gap: 10px; }
    .center { text-align:center; }
    @media (min-width: 520px) { .logger-grid { grid-template-columns: 1fr auto 1fr; align-items: end; } }

    /* Calendar */
    .cal-wrap { background: var(--card); border: 1px solid #eee; border-radius: 16px; padding: 10px; }
    .cal-head { display: flex; align-items: center; gap: 8px; padding: 8px; flex-wrap: wrap; }
    .cal-title { font-weight: 700; }
    .cal-grid { display: grid; grid-template-columns: repeat(7, 1fr); gap: 6px; padding: 8px; }
    .dow { text-align: center; font-size: 12px; color: var(--muted); }
    .day { border: 1px solid #eee; border-radius: 12px; padding: 8px; min-height: 80px; position: relative; background: #fff; }
    .day .n { position: absolute; top: 8px; left: 8px; font-size: 12px; color: #6b7280; }
    .day .h { position: absolute; bottom: 8px; right: 8px; font-weight: 700; font-size: 12px; color: #111; }
    .day.today { outline: 2px solid #111; }
    .legend { display:flex; gap:8px; align-items:center; font-size:12px; color:var(--muted); padding: 0 8px 8px; }

    /* Breaks list */
    .breaks { display: none; margin-top: 10px; }
    .breaks.active { display: block; }
    .break-item { display: grid; grid-template-columns: 1.2fr 1fr 1fr auto; gap: 8px; align-items: end; margin-bottom: 8px; }
    .break-item small { color: var(--muted); display:block; margin-bottom:4px; }
    .muted { color: var(--muted); font-size: 13px; }
    .total { display: flex; justify-content: space-between; align-items: center; padding-top: 6px; }

    /* Drawer for day details */
    .drawer { margin-top: 10px; background:#fff; border:1px solid #eee; border-radius:12px; padding:12px; display:none; }
    .drawer.active { display:block; }
    .row { display:flex; gap:8px; flex-wrap:wrap; }
    .chip { border:1px solid #e5e7eb; border-radius:999px; padding:4px 10px; font-size:12px; background:#fff; }
  </style>
</head>
<body>
  <div class="topbar">
    <button class="back" id="btnBack" style="visibility:hidden">◀︎ Back</button>
    <div class="title">Hour Logger</div>
    <div class="spacer"></div>
    <span class="pill" id="pillToday">—</span>
  </div>

  <!-- MENU VIEW -->
  <section id="view-menu" class="view active">
    <div class="hero"><h1>Track your day</h1></div>

    <div style="margin-top:12px; display:flex; gap:8px; align-items:center; flex-wrap:wrap;">
      <span class="pill" id="pillTodayHours">Today: 0 h</span>
      <span class="pill" id="pillMonthHours">This month: 0 h</span>
      <span class="pill" id="pillOT">Overtime: 0 h</span>
    </div>

    <div class="cards">
      <!-- Today's logging first -->
      <div class="card">
        <div>
          <h3 id="todayCardTitle">Today’s logging</h3>
          <p>Log start/stop, breaks, and save.</p>
        </div>
        <button id="goLogger">Open</button>
      </div>

      <div class="card">
        <div>
          <h3>Calendar</h3>
          <p>See/edit any day’s details.</p>
        </div>
        <button id="goCalendar">Open</button>
      </div>

      <div class="card">
        <div>
          <h3>Compensate overtime</h3>
          <p>Reduce your overtime by logging paid time off/early leave.</p>
        </div>
        <button id="goComp">Add</button>
      </div>

      <div class="card">
        <div>
          <h3>Daily target</h3>
          <p>Currently <span id="targetLabel">8h 24m</span>. Used to compute overtime.</p>
        </div>
        <button id="goTarget">Change</button>
      </div>
    </div>
  </section>

  <!-- CALENDAR VIEW -->
  <section id="view-calendar" class="view">
    <div class="cal-wrap">
      <div class="cal-head">
        <button class="btn" id="calPrev">◀︎</button>
        <div class="cal-title" id="calTitle">Month YYYY</div>
        <button class="btn" id="calNext">▶︎</button>
        <div class="spacer"></div>
        <button class="btn" id="calToday">Today</button>
      </div>
      <div class="legend">
        <span>Target: <strong id="legendTarget">8h 24m</strong></span>
        <span class="chip" id="legendOT">Overtime month: 0 h</span>
      </div>
      <div class="cal-grid" id="calDOW"></div>
      <div class="cal-grid" id="calGrid"></div>
      <div class="drawer" id="dayDrawer"></div>
    </div>
  </section>

  <!-- LOGGER VIEW -->
  <section id="view-logger" class="view">
    <div class="group">
      <label>Date</label>
      <input type="date" id="logDate" />
    </div>

    <div class="group">
      <div class="logger-grid">
        <div>
          <label><strong>Start</strong></label>
          <input type="time" id="startTime" />
          <button class="btn" id="btnStartNow" style="margin-top:8px; width:100%">Start now</button>
        </div>
        <div class="center">
          <button class="btn" id="btnAddBreak">+ Add break</button>
          <div class="breaks" id="breaksPane"></div>
        </div>
        <div>
          <label><strong>Stop</strong></label>
          <input type="time" id="stopTime" />
          <button class="btn" id="btnStopNow" style="margin-top:8px; width:100%">Stop now</button>
        </div>
      </div>
      <div class="total">
        <span class="muted">Net working time (breaks subtracted)</span>
        <strong id="computedTotal">0.00 h</strong>
      </div>
    </div>

    <div class="group">
      <button class="btn primary" id="btnSave">Save to calendar</button>
    </div>
  </section>

  <!-- COMPENSATE OVERTIME VIEW -->
  <section id="view-comp" class="view">
    <div class="group">
      <label>Date for compensation</label>
      <input type="date" id="compDate" />
    </div>
    <div class="group">
      <div class="row">
        <div>
          <label>Compensation minutes (e.g., leaving early)</label>
          <input type="number" id="compMins" placeholder="e.g., 60" />
        </div>
        <div>
          <label>Note (optional)</label>
          <input type="text" id="compNote" placeholder="Doctor, PTO, etc." />
        </div>
      </div>
    </div>
    <div class="group">
      <button class="btn primary" id="btnSaveComp">Save compensation</button>
      <p class="muted" style="margin-top:8px">Compensation subtracts from your overtime but does not count as worked hours.</p>
    </div>
  </section>

  <!-- TARGET SETTINGS VIEW -->
  <section id="view-target" class="view">
    <div class="group">
      <label>Daily target (HH:MM)</label>
      <div class="row">
        <div><input type="number" id="targetH" min="0" max="12" value="8" /></div>
        <div><input type="number" id="targetM" min="0" max="59" value="24" /></div>
      </div>
      <p class="muted" style="margin-top:8px">Used for overtime in Calendar & Menu (applies Mon–Fri).</p>
    </div>
    <div class="group">
      <button class="btn primary" id="btnSaveTarget">Save target</button>
    </div>
  </section>

  <script>
    // ---- Persistence (schema v3) ----
    const KEY = 'hourlogger.v3';
    const state = JSON.parse(localStorage.getItem(KEY) || '{}');
    state.days ||= {}; // { 'YYYY-MM-DD': { type:'work', start:'HH:MM', stop:'HH:MM', breaks:[{name,start,stop}], netMins:number } } or {type:'comp', mins, note}
    state.targetMins ||= 504; // default 8h24m

    function save(){ localStorage.setItem(KEY, JSON.stringify(state)); }

    // ---- Date helpers ----
    const pad = n => String(n).padStart(2,'0');
    const toDateStr = d => `${d.getFullYear()}-${pad(d.getMonth()+1)}-${pad(d.getDate())}`;
    const fromDateStr = s => { const [y,m,da]=s.split('-').map(Number); return new Date(y, m-1, da); };
    const monthNames = ['January','February','March','April','May','June','July','August','September','October','November','December'];
    const dows = ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'];
    const fmtHM = mins => `${Math.floor(mins/60)}h ${pad(mins%60)}m`;

    // ---- View management ----
    const views = { menu: document.getElementById('view-menu'), calendar: document.getElementById('view-calendar'), logger: document.getElementById('view-logger'), comp: document.getElementById('view-comp'), target: document.getElementById('view-target') };
    const btnBack = document.getElementById('btnBack');
    function show(name){ Object.values(views).forEach(v=>v.classList.remove('active')); views[name].classList.add('active'); btnBack.style.visibility = (name==='menu') ? 'hidden' : 'visible'; if (name==='menu') renderMenu(); if (name==='calendar') renderCalendar(); if (name==='logger') renderLogger(); if (name==='comp') renderComp(); if (name==='target') renderTarget(); }
    btnBack.addEventListener('click', ()=>show('menu'));

    // ---- Menu ----
    const pillToday = document.getElementById('pillToday'), pillTodayHours = document.getElementById('pillTodayHours'), pillMonthHours = document.getElementById('pillMonthHours'), pillOT = document.getElementById('pillOT'), todayCardTitle = document.getElementById('todayCardTitle'), targetLabel = document.getElementById('targetLabel');
    document.getElementById('goCalendar').addEventListener('click', ()=>show('calendar'));
    document.getElementById('goLogger').addEventListener('click', ()=>show('logger'));
    document.getElementById('goComp').addEventListener('click', ()=>show('comp'));
    document.getElementById('goTarget').addEventListener('click', ()=>show('target'));

    function sumDayMins(ds){ const d = state.days[ds]; if (!d) return 0; return d.type==='work' ? (d.netMins||0) : 0; }
    function sumMonthMins(year, month){ let total=0; for (let d=new Date(year,month,1); d<=new Date(year,month+1,0); d.setDate(d.getDate()+1)) total += sumDayMins(toDateStr(d)); return total; }
    function sumMonthOT(year, month){
      let worked=0, comp=0, target=0;
      for (let d=new Date(year,month,1); d<=new Date(year,month+1,0); d.setDate(d.getDate()+1)){
        const ds = toDateStr(d), rec = state.days[ds]; const dow=d.getDay(); const isWeekday=dow>=1&&dow<=5;
        if (rec?.type==='work') worked += rec.netMins||0;
        if (rec?.type==='comp') comp += rec.mins||0;
        if (isWeekday) target += state.targetMins;
      }
      return worked - target - comp; // positive => overtime
    }

    function renderMenu(){
      const now = new Date(); const dStr = toDateStr(now);
      pillToday.textContent = dStr; todayCardTitle.textContent = "Today’s logging"; targetLabel.textContent = fmtHM(state.targetMins);
      pillTodayHours.textContent = "Today: " + (sumDayMins(dStr)/60).toFixed(2) + " h";
      pillMonthHours.textContent = "This month: " + (sumMonthMins(now.getFullYear(), now.getMonth())/60).toFixed(2) + " h";
      const ot = sumMonthOT(now.getFullYear(), now.getMonth()); pillOT.textContent = "Overtime: " + (ot/60).toFixed(2) + " h";
    }

    // ---- Calendar ----
    const calTitle = document.getElementById('calTitle'), calDOW = document.getElementById('calDOW'), calGrid = document.getElementById('calGrid'), dayDrawer = document.getElementById('dayDrawer'); let monthOffset = 0;
    function startOfMonthWithMondayGrid(date){ const first = new Date(date.getFullYear(), date.getMonth(), 1); const day = (first.getDay() + 6) % 7; first.setDate(first.getDate() - day); first.setHours(0,0,0,0); return first; }
    function renderCalendar(){
      const base = new Date(); base.setMonth(base.getMonth()+monthOffset);
      calTitle.textContent = monthNames[base.getMonth()] + " " + base.getFullYear();
      document.getElementById('legendTarget').textContent = fmtHM(state.targetMins);
      document.getElementById('legendOT').textContent = "Overtime month: " + (sumMonthOT(base.getFullYear(), base.getMonth())/60).toFixed(2) + " h";
      calDOW.innerHTML=''; ['Mon','Tue','Wed','Thu','Fri','Sat','Sun'].forEach(d=>{ const el=document.createElement('div'); el.textContent=d; el.className='dow'; calDOW.appendChild(el); });
      calGrid.innerHTML=''; dayDrawer.classList.remove('active');
      const start = startOfMonthWithMondayGrid(base);
      for (let i=0;i<42;i++){ const d = new Date(start); d.setDate(start.getDate()+i); const ds = toDateStr(d); const el = document.createElement('div'); el.className='day'; if (ds===toDateStr(new Date())) el.classList.add('today'); el.innerHTML = `<span class="n">${d.getDate()}</span>`; const rec = state.days[ds];
        if (rec?.type==='work'){ const hh=document.createElement('span'); hh.className='h'; hh.textContent=(rec.netMins/60).toFixed(2)+' h'; el.appendChild(hh); }
        else if (rec?.type==='comp'){ const hh=document.createElement('span'); hh.className='h'; hh.textContent='-'+(rec.mins)+'m'; el.appendChild(hh); }
        el.addEventListener('click', ()=>openDayDrawer(ds)); calGrid.appendChild(el); }
    }
    function openDayDrawer(ds){
      const rec = state.days[ds]; let html = `<div class="row"><strong>${ds}</strong></div>`;
      if (rec?.type==='work'){ html += `<div class="row" style="margin-top:8px"><div class="chip">Start ${rec.start||'-'}</div><div class="chip">Stop ${rec.stop||'-'}</div><div class="chip">Total ${(rec.netMins/60).toFixed(2)} h</div></div>`;
        if (rec.breaks?.length){ html += `<div class="muted" style="margin-top:8px">Breaks</div>`; rec.breaks.forEach(b=>{ html += `<div class="row"><div class="chip">${b.name||'Break'}</div><div class="chip">${b.start||'--:--'} → ${b.stop||'--:--'}</div></div>`; }); }
        else { html += `<p class="muted" style="margin-top:8px">No breaks logged.</p>`; }
        html += `<div class="row" style="margin-top:10px"><button class="btn" id="drawerEdit">Edit this day</button></div>`;
      } else if (rec?.type==='comp'){ html += `<p class="muted" style="margin-top:8px">Compensation: ${rec.mins} min • ${rec.note||'-'}</p><div class="row" style="margin-top:10px"><button class="btn" id="drawerEditComp">Edit compensation</button></div>`; }
      else { html += `<p class="muted" style="margin-top:8px">No entries yet.</p><div class="row" style="margin-top:10px"><button class="btn" id="drawerAdd">Add work entry</button></div>`; }
      dayDrawer.innerHTML = html; dayDrawer.classList.add('active');
      const dateInput = document.getElementById('logDate');
      const btnE = document.getElementById('drawerEdit'); if (btnE) btnE.onclick = ()=>{ dateInput.value = ds; loadDayIntoLogger(ds); show('logger'); };
      const btnA = document.getElementById('drawerAdd'); if (btnA) btnA.onclick = ()=>{ dateInput.value = ds; clearLogger(); show('logger'); };
      const btnC = document.getElementById('drawerEditComp'); if (btnC) btnC.onclick = ()=>{ document.getElementById('compDate').value = ds; loadCompIntoForm(ds); show('comp'); };
    }
    document.getElementById('calPrev').addEventListener('click', ()=>{ monthOffset--; renderCalendar(); });
    document.getElementById('calNext').addEventListener('click', ()=>{ monthOffset++; renderCalendar(); });
    document.getElementById('calToday').addEventListener('click', ()=>{ monthOffset=0; renderCalendar(); });

    // ---- Logger with breaks ----
    function nowHHMM(){ const n=new Date(); return `${pad(n.getHours())}:${pad(n.getMinutes())}`; }
    function parseHHMM(t){ const [h,m]=t.split(':').map(Number); return h*60 + m; }
    function validTime(t){ return /^\d{2}:\d{2}$/.test(t); }
    const breaksPane = document.getElementById('breaksPane');

    function computeTotal(){
      const a = document.getElementById('startTime').value.trim(); const b = document.getElementById('stopTime').value.trim();
      if (!validTime(a) || !validTime(b)) { document.getElementById('computedTotal').textContent = '0.00 h'; return 0; }
      let work = parseHHMM(b) - parseHHMM(a); if (work<0) work += 24*60;
      let breakTotal = 0; breaksPane.querySelectorAll('.break-item').forEach(it=>{ const s=it.querySelector('.bi-start').value.trim(); const e=it.querySelector('.bi-stop').value.trim(); if (validTime(s)&&validTime(e)){ let mins=parseHHMM(e)-parseHHMM(s); if (mins>0) breakTotal += mins; } });
      const net = Math.max(0, work - breakTotal); document.getElementById('computedTotal').textContent = (net/60).toFixed(2) + ' h'; return net;
    }
    function addBreakRow(initial={name:'', start:'', stop:''}){
      const row = document.createElement('div'); row.className='break-item'; row.innerHTML = `
        <div><small>Name</small><input type="text" class="bi-name" placeholder="Lunch / Errand" value="${initial.name||''}"></div>
        <div><small>Start</small><input type="time" class="bi-start" value="${initial.start||''}"></div>
        <div><small>Stop</small><input type="time" class="bi-stop" value="${initial.stop||''}"></div>
        <div><button class="btn danger bi-del">Remove</button></div>`;
      breaksPane.appendChild(row); document.getElementById('breaksPane').classList.add('active');
      row.querySelectorAll('input').forEach(inp=>inp.addEventListener('input', computeTotal));
      row.querySelector('.bi-del').addEventListener('click', ()=>{ row.remove(); if(!breaksPane.querySelector('.break-item')) breaksPane.classList.remove('active'); computeTotal(); });
      computeTotal();
    }
    function clearLogger(){ document.getElementById('startTime').value=''; document.getElementById('stopTime').value=''; breaksPane.innerHTML=''; breaksPane.classList.remove('active'); document.getElementById('computedTotal').textContent='0.00 h'; }
    function loadDayIntoLogger(ds){
      clearLogger(); const rec = state.days[ds]; if (rec?.type!=='work') return;
      document.getElementById('logDate').value = ds; document.getElementById('startTime').value = rec.start||''; document.getElementById('stopTime').value = rec.stop||''; (rec.breaks||[]).forEach(b=>addBreakRow(b)); computeTotal();
    }
    function renderLogger(){ const dateInput=document.getElementById('logDate'); if(!dateInput.value) dateInput.value = toDateStr(new Date()); const rec = state.days[dateInput.value]; if(rec?.type==='work') loadDayIntoLogger(dateInput.value); else clearLogger(); }

    document.getElementById('btnStartNow').addEventListener('click', ()=>{ document.getElementById('startTime').value = nowHHMM(); computeTotal(); });
    document.getElementById('btnStopNow').addEventListener('click',  ()=>{ document.getElementById('stopTime').value  = nowHHMM(); computeTotal(); });
    document.getElementById('btnAddBreak').addEventListener('click', ()=> addBreakRow());
    document.getElementById('startTime').addEventListener('input', computeTotal);
    document.getElementById('stopTime').addEventListener('input', computeTotal);

    document.getElementById('btnSave').addEventListener('click', ()=>{
      const dateStr = document.getElementById('logDate').value || toDateStr(new Date());
      const a = document.getElementById('startTime').value.trim();
      const b = document.getElementById('stopTime').value.trim();
      if (!validTime(a) || !validTime(b)) { alert('Enter both start and stop times'); return; }
      const net = computeTotal(); const breaks=[];
      breaksPane.querySelectorAll('.break-item').forEach(it=>{ breaks.push({ name: it.querySelector('.bi-name').value.trim(), start: it.querySelector('.bi-start').value.trim(), stop: it.querySelector('.bi-stop').value.trim() }); });
      state.days[dateStr] = { type:'work', start:a, stop:b, breaks, netMins: net }; save(); show('menu');
    });

    // ---- Compensation ----
    function renderComp(){ const ds = toDateStr(new Date()); document.getElementById('compDate').value ||= ds; document.getElementById('compMins').value ||= ""; document.getElementById('compNote').value ||= ""; }
    function loadCompIntoForm(ds){ const rec = state.days[ds]; if (rec?.type==='comp'){ document.getElementById('compDate').value=ds; document.getElementById('compMins').value=rec.mins||0; document.getElementById('compNote').value=rec.note||''; } }
    document.getElementById('btnSaveComp').addEventListener('click', ()=>{ const ds=document.getElementById('compDate').value||toDateStr(new Date()); const mins=Math.max(0, parseInt((document.getElementById('compMins').value||'0'),10)); const note=document.getElementById('compNote').value.trim(); if(!mins){ alert('Enter minutes to compensate'); return; } state.days[ds]={ type:'comp', mins, note }; save(); show('menu'); });

    // ---- Target ----
    function renderTarget(){ const h=Math.floor(state.targetMins/60), m=state.targetMins%60; document.getElementById('targetH').value=h; document.getElementById('targetM').value=m; }
    document.getElementById('btnSaveTarget').addEventListener('click', ()=>{ const h=parseInt(document.getElementById('targetH').value||'0',10); const m=parseInt(document.getElementById('targetM').value||'0',10); state.targetMins = Math.max(0, (h*60 + m)|0); save(); show('menu'); });

    // ---- Boot + migration ----
    (function boot(){
      const old = localStorage.getItem('hourlogger.v2');
      if (old && !state._migrated){ try { const o=JSON.parse(old); if (o.entries?.length) o.entries.forEach(e=>{ const mins=Math.round((e.hours||0)*60); state.days[e.date]={ type:'work', start:'', stop:'', breaks:[], netMins: mins }; }); state._migrated=true; save(); } catch(e){} }
      show('menu'); if ('serviceWorker' in navigator) navigator.serviceWorker.register('./service-worker.js');
    })();
  </script>
</body>
</html>
